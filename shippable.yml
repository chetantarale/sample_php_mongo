build_image: chetantarale/u14php7pls:testext1

language: php

php: 
  - "7.0"

services:
  - mongodb
  
before_script: 
  - currentLocation="$PWD"
  - sudo su -c /usr/bin/mongod -f /etc/mongod.conf --smallfiles > /dev/null 2>&1 &
  - echo "extension=mongo.so" > /etc/php/7.0/cli/php.ini
  - echo "extension=mongo.so" > /etc/php/7.0/fpm/php.ini
  - sudo service php7.0-fpm restart
  - mkdir -p shippable/testresults
  - mkdir -p shippable/codecoverage
  - wget https://phar.phpunit.de/phpunit.phar
  - chmod +x phpunit.phar
  - sudo mv phpunit.phar /usr/local/bin/phpunit
  - phpunit --version
  - cd "$currentLocation"

script:
  - phpunit  --log-junit shippable/testresults/junit.xml --coverage-xml shippable/codecoverage tests/ConnectToMongoTest.php
  
notifications:
   email: false
